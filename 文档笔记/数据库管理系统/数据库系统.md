# 数据库系统概述

## 1、 数据库的四个基本概念：

①数据：描述事物的符号记录。

②数据库(DB)：概括地讲，数据库数据具有**永久存储、有组织和可共享**的三个基本特点。

> 严格地讲：数据库是⻓期储存在计算机内、有组织的、可共享的⼤量数据的集合。数据库中的数据按⼀定的数据模型组织、描述和储存，具有较⼩的冗余度、较⾼的数据独性和易扩展性，并可为各种⽤户共享。

③数据库管理系统(DBMS)：是位于⽤户和操作系统之间的⼀层数据管理软件。和操作系统⼀样是计算机的基础软件。

> 主要功能：
> 
> 1、数据定义功能  2、数据组织、存储和管理 3、数据操纵功能  4、数据库的事务管理和运⾏管理 5、数据库的建⽴和维护功能 6、其他功能（通信功能，数据转换功能，互访和互操作功能等）

④数据库系统(DBS)：是由**数据库**、**数据库管理系统**（及其应⽤开发⼯具）、**应⽤程序**和**数据库管理员**（DBA）组成的存储、管理、处理和维护数据的系统。

数据库系统的基本特征：共享性、独立性、亢余度小

## 2、数据库的发展阶段

1. ⼈⼯管理阶段：数据不保存、不共享，不具有独⽴性。

2. ⽂件系统阶段：可保存，但共享性差，冗余度⼤，独⽴性差。

3. 数据库管理系统： 数据库系统的出现使信息系统从以 加⼯数据的程序为中⼼转向围绕 共享的数据库为中⼼的新阶段，数据由数据库管理系统统⼀管理和控制，

4. 实现整体数据的结构化，数据的共享性⾼、冗余度低且易扩充：数据共享可以⼤⼤减少数据冗余，节约存储空间

5. 数据独⽴性⾼

物理独⽴性：是指⽤户的应⽤程序与数据库中数据的物理存储是相互独⽴的。
逻辑独⽴性：是指⽤户的应⽤程序与数据库的逻辑结构是相互独⽴的。

## 3、数据模型

由**数据结构、数据操作、完整性约束**三部分组成

***概念模型***：也称信息模型，它是按⽤户观点来对数据和信息建模，主要⽤于数据库设计。

> 实体：客观存在并可相互区别的事物。 ⼈
> 
> 属性：实体所具有的某⼀特性。 ⼈的⿐⼦ 嘴巴
> 
> 码：唯⼀标识实体的属性。 学号
> 
> 实体型：⽤实体名及其属性集合来抽象和刻画同类实体。 含有⿐⼦和嘴巴的⼈
> 
> 实体集：同⼀类型实体的集合。学校
> 
> 联系：实体之间的联系通常是指不同实体集之间的联系。
> 
>             实体之间的联系有⼀对⼀、⼀对多和多对多等多种联系。
> 
> 概念模型的⼀种表示⽅法：实体-联系⽅法。

***逻辑模型***：它是按计算机系统的观点对数据建模，主要⽤于数据库管理系统的实现。

包括：层次模型、⽹状模型、关系模型

| 名称      | 内容                                                                                                              |
| ------- | --------------------------------------------------------------------------------------------------------------- |
| 层次模型（树） | 只有一个根节点<br>1、有且只有⼀个结点没有双亲结点，这个结点称为根结点。<br/>2、根以外的其他结点有且只有⼀个双亲结点。                                                |
| ⽹状模型（图） | 1、允许⼀个以上的结点⽆双亲。<br/>2、⼀个结点可以有多于⼀个双亲。                                                                            |
| 关系模型（表） | 关系：⼀个关系对应通常说的⼀张表。<br/>元组：表中的⼀⾏。<br/>属性：表中的⼀列。<br/>码：也称码键，表中的某个属性组。（主键）<br/>域：是⼀组具有相同数据类型的值的集合。<br/>分量：元组中的⼀个属性。 |

***物理模型***：是对数据最底层的抽象，它描述数据在系统内部的表示⽅法和存取⽅法，或在磁盘或磁带上的存储⽅式和存取⽅法，是⾯向计算机系统的。

## 4、数据库系统的结构

三级模式结构：外模式+模式+内模式

⼆级映像

**外模式**

> 也称⼦模式或⽤户模式，它是数据库⽤户（包括应⽤程序员和最终⽤户能够看⻅和使⽤的局部数据的逻辑结构和特征的描述，是数据库⽤户的数据视图，是与某⼀应⽤有关的数据的逻辑表示。

   **外模式/模式映像**

> > 当模式改变时，由数据库管理员对各个外模式/模式映像作相应改变，可以使外模式保持不变。应⽤程序不必修改。保证了数据与程序的逻辑独⽴性。

**模式**

> 也称为逻辑模式，是数据库中全体数据的逻辑结构和特征的描述，是所有⽤户的公共数据视图

   **模式/内模式映像**

> > 当数据库的存储结构改变时，有数据库管理员对模式/内模式作相应改变，可以使模式保持不变从⽽应⽤程序也不⽤改变。保证了数据与程序的物理独⽴性。

**内模式**

> 也称存储模式，⼀个数据库只有⼀个内模式。它是数据物理结构和存储⽅式的描述，是数据在数据库内部的组织⽅式。

## 5、数据库系统的组成

+ **硬件平台及数据库**：⾜够⼤内存、磁盘或磁盘阵列等设备，较⾼的通道能⼒以提⾼数据的传送率

+ **软件**：数据库管理系统，⽀持数据库管理系统运⾏的操作系统，具有与数据库接⼝的⾼级语⾔及其编译系统，以数据库管理系统为核⼼的应⽤开发⼯具，为特定应⽤环境开发的数据库应⽤系统。

+ **⼈员**：开发、管理和使⽤数据库的⼈员主要包括数据库管理员、系统分析员和数据库设计⼈员、应⽤程序员和最终⽤户。

+ **数据库管理员职责**：决定数据库中的信息内容和结构、决定数据库的存储结构和存取策略、定义数据的安全性要求和完整性约束条件、监控数据库的使⽤和运⾏、数据库的改进和重组、重构。

# 关系数据库

关系数据语言可分为3类：SQL语言、关系演算语言、关系代数语言

## 1、 关系模式

任何一个关系模式一定有键

2个属性一定没有传递依赖（因为至少3个才有传递依赖）

## 2、关系代数语⾔

5种基本的运算：并、差、笛卡尔积、选着、投影

关系代数操作的对象和操作结果都是**关系**

**并**：2个集合，合并在一起

**差**：A-B，从A中去除B的内容

**交**：2个集合相同的部分

**笛卡⼉积**

> A\*B，先取A中的第一行，与B的每一样组合在一起，然后取A的下一行继续，直到全部组合完毕

**选择**：sdept="IS"既是条件Student是表

![](D:\A-SYS-reject\whiteZe\文档笔记\数据库管理系统\images\7.png)

![](D:\A-SYS-reject\whiteZe\文档笔记\数据库管理系统\images\2.png)

**投影**：选着属性列

![](D:\A-SYS-reject\whiteZe\文档笔记\数据库管理系统\images\3.png)

**连接**

> 自然连接：只保留A，B属性相等的行
> 
> 外连接：不相等的也保留，没有的属性写NULL
> 
> 左连接：AB，保留左边（A）的属性
> 
> 右连接：AB，保留左边（B）的属性

**除（R/S)**

> 1、在R中选中属性值为S中的属性值，有多个保存多个，每一行算1个
> 
> 2、去掉列名为S中的列名

# 数据库安全性

***不安全因素***：⾮授权对数据库的恶意存取和破坏、数据库中重要的数据泄露、安全环境的脆弱性

**数据库安全性控制**

1. ⽤户身份鉴别：静态⼝令鉴别，动态⼝令鉴别，⽣物特征鉴别，智能卡鉴别

2. 存取控制

3. ⾃主存取控制⽅法：⽤户可以⾃定义和分配其他⽤户的操作权限，主要通过grant revoke来进⾏控制，由两个元素构成: 数据库对象 和 操作权限，我们定义⽤户的存取权限 成为授权

# 数据库的完整性

1. 正确性：符合现实世界的描述

2. 相容性：同⼀对象在不同表⾥⾯是符合逻辑的，⽐如我的地址，年龄在两个表⾥⾯都应⼀致

3. 维护完整性：提供定义完整性约束条件的机制、提供完整性检查的⽅法、进⾏违约处理

**三大完整性**

1. 实体完整性，主码（主属性）唯⼀，且⾮空

2. 参照完整性，外码的要么没有,要么只有⼀个

3. ⽤户定义完整性：⾮空（not null），列值唯一（unique）、满⾜某⼀个条件表达式（check）

# 数据库恢复技术

## 1、事务ACID

1. 原⼦性（autom）：要么全做，要么全不做

2. ⼀致性（consistent）：⼀致性与原⼦性密切相关，要么全做要么全不做

3. 隔离性（isolate）：⼀个事务的执⾏不能被其他事务所⼲扰

4. 持久性 （duration）： 数据库的改变是永久的。

![](D:\A-SYS-reject\whiteZe\文档笔记\数据库管理系统\images\6.png)

## 2、故障种类

事物内部故障、系统故障、介质故障（外部存储损坏）、硬件损坏、计算机病毒

# 关系数据理论

## 1、三大范式

**1NF**：所有字段值都是<u>不可分解的原⼦值</u>（地址 可以分为 省份，城市，详细地址）

**2NF**：不包含⾮主属性对码的部分函数依赖，<u>⼀个表中只能保存⼀种数据</u>，不可以把多种数据保存在同⼀张数据库表中（比如订单表，不能包含商品信息）

**3NF**：不包含⾮主属性对码的<u>传递函数依赖</u>，确保数据表中的每⼀列数据都和主键直接相关，⽽不能间接相关

**BCNF**：消除每⼀属性对候选键的<u>传递依赖</u> ,BCNF是修正的第三范式（例，书号->书名，(书名，书号)->作者

## 2、+ 候选码

> 步骤1
> 
> 只出现在左边的⼀定是候选码
> 
> 只出现在右边的⼀定不是候选码
> 
> 左右都出现的不⼀定
> 
> 左右都不出现的⼀定是候选码
> 
> 步骤2
> 
> 再求**确定的候选码**的闭包,如果可以推出全部,那么当前确定的就是候选码。否则，你要吧每⼀个可能的值，放进当前确定的候选码⾥⾯进⾏求 闭包

例：R<U,F> ,U(A，B，C，D，E，G) , F={AB->C，CD->E，E-->A，A-->G)

1、B，D⼀定是候选码，G⼀定不是候选码，A，C，E不⼀定

2、确定候选码，BD什么也不能推出，

3、进行BD与可能是候选码的关系进行闭包推算，

(BDA)+= C E A G 所以可以退出ABCDEG

> (BDA)+=C， AB->C
> 
> (BDA)->(CD)+=E，CD->E
> 
> (BDA)->(CD)->(E)->(A)->(G)

(BDC)+= E A G 所以可以退出ABCDEG

(BDE)+= A G C 可以退出ABCDEG

所以候选码为 { (BDA), (BDC), (BDE) }

超码: 能表示出所有属性的集合, ⽐如 (BDA),(BDC),(BDE) BDCA BDEA ABCDE

候选码是最⼩的超码.

主码: 从候选码⾥⾯任意跳出⼀个 作为主码

主属性: 包含在所有候选码的属性 ⽐如ABCDE

⾮主属性: 不包含在候选码中的属性 ,上题为G

全码: 所有的属性都是主码

## 3、+ 求最⼩函数的依赖集

如何求最⼩依赖集?

1)拆右边为多个元素的，⽐如A->BC 拆为 A->B 和A->C

2)除去当前元素,求它的闭包，把集合⾥⾯所有元素都弄完

3)左边最⼩化（通过遮住元素来看能不能退出其他元素），

例题：

已知关系 R<U,F> ,U{A,B,C,D,E,F,G}，F={BCD->A，BC->E，A->F，F->G，C->D，A->G}

求F的最⼩依赖集

1、拆右边为多个元素，题目中没有

2、除去当前元素,求它的闭包，把集合⾥⾯所有元素都弄完

> BCD->A，去掉不看，根据剩下的关系求 (BCD)+
> 
> (BCD)+=BCD ED # 一定能推车自己，所以BCD->A必须保留

得BCD->A，BC->E，A->F，F->G，C->D

3、左边最⼩化（只对左边多个元素进行化简）

> 由BCD->A，
> 
> CD能得出A吗，不能，B保留。BD能得到A吗，不能，C保留。
> 
> BC能得到A吗，BC->E，C->D（BC中包含C），去掉D

BC->A，BC->E，A->F，F->G，C->D

## 4、公理系统

1、自反律、增广律、传递律

合并规则，（X->Y，X->Z，则X->Z）

伪传递规则，（X->Y, WX->Z，则XW->Z）

分解规则, （X->Y, Z属于Y，则X->Z）

## 5、模式分解

准则: ⽆损连接 和 保持函数依赖

⽆损: 就是分解后再次连接,和分解之前⼀样

依赖: 依赖不变

# 关系数据库设计

6个阶段：需求分析、概念结构设计、逻辑结构设计、物理结构设计、数据库实施、数据库运行、维护阶段

# 并发控制

**并发带来的问题**：丢失修改、读脏数据、不可重复读

**解决方法**：

1. 排它锁：也叫写锁（X锁）Xlock  unlock

2. 共享锁：也叫读锁（S锁）Slock

**封锁协议**

+ ⼀级封锁协议：修改时，必须加X锁，直到结束（解决丢失修改）

+ ⼆级封锁协议：读的时候，加S锁，⽤完就放（解决读脏数据）

+ 三级封锁协议：读的时候，加S锁，直到结束（解决不可重复度）

## 三级锁协议题型

# + 例题

已知R(ABCDEGH)，F={A->D，E->D，D->B，BC-D，DC->A}，求保持函数依赖的3NF的分解

1、求出最⼩函数依赖集

F={A->D，E->D，D->B，BC->D，DC->A}

2、把不在F⾥⾯的属性都找出来单独分⼀类

F的属性是ADEBC，R的属性是ABCDEGH，所以得结果{GH}

3、把每⼀个依赖左边相同的分成⼀类，没有⼀样的，那么就把A->D改为{AD}

    相同：{A->B，A->C} => {ABC}

    不同：{A->D} => {AD}

{AD}，{ED}，{DB}，{BC}，{DCA}

4、求候选码，如果候选码没出现在分离⾥⾯, 把任意⼀个候选码作为⼀类

候选码：CE

将最小函数依赖写下：{AD}，{ED}，{DB}，{BC}，{DCA}

添加**候选码**和**不在F⾥⾯的属性**则最终结果

{AD}，{ED}，{DB}，{BC}，{DCA}   {CE}{GH}

## + ER图题型

![](D:\A-SYS-reject\whiteZe\文档笔记\数据库管理系统\images\1.png)

1、文字描述转ER图

注意：题目中出现的属性是固定的，当条件中提出多个属性时，应添加在条件上

2、ER图转关系

## 1：1（AB表）

把 关系 上的属性放到任意一个表中（设A），并把 B表的主键 放到一个 A表 中

## 1：n

**关系**上的属性放到 n表 中，把**1的主键**也放到n表中

## n：m

将 **关系属性** 生成一个新表，并保存**nm表的主键**
